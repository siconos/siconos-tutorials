
variables:
  # Default ctest model. Warning : overwritten if set in schedules variables (as we expect)
  ctest_build_model: Continuous
  # Default behavior regarding cdash submission
  cdash_submit: 0

# -- Template for examples build-test-install jobs --
# - Pull an image (possibly from siconos-tutorials registry)
#   named  IMAGE_NAME
.examples-build:
  image: $IMAGE_NAME
  stage: test
  variables:
    SICONOS_INSTALL_DIR: /home/install-siconos # where to find siconos binary
    CMAKE_PREFIX_PATH: $SICONOS_INSTALL_DIR  # required by cmake to find siconos-config
  script:
    - sh ci_gitlab/build_and_run_examples.sh

# examples, on ubuntu20 with a standard (default)
# Siconos installation (based on current development, master branch, version
run-examples:ubuntu-20:
  variables:
    IMAGE_NAME: $CI_REGISTRY_IMAGE/siconos-master
    cdash_submit: 1
  extends: .examples-build


# examples, with a standard (default) Siconos installation
# with version from release 4.4 (latest)
# Triggered manualy.
run-examples:release:
  variables:
    IMAGE_NAME: $CI_REGISTRY_IMAGE/siconos-release-4.4
    cdash_submit: 1
  extends: .examples-build
  when: manual
